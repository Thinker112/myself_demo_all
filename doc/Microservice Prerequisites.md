# 使用微服务的先决条件

当我与人们谈论使用[微服务架构风格](https://martinfowler.com/articles/microservices.html)时，我听到了很多乐观的声音。 开发人员喜欢使用较小的单元，并期望比整体式单元具有更好的模块化性。 但与任何架构决策一样，都需要权衡。 特别是微服务会给运维带来严重后果，运维现在必须处理小型服务的生态系统，而不是单个、定义明确的整体。 因此，如果您不具备某些基本能力，则不应考虑使用微服务风格。

- **快速配置**：您应该能够在几个小时内启动新服务器。 当然，这适合[云计算](https://martinfowler.com/bliki/CloudComputing.html)，但它也可以在没有完整云服务的情况下完成。 为了能够进行如此快速的配置，您将需要大量的自动化 - 一开始可能不需要完全自动化，但稍后要进行重要的微服务，则需要实现这种方式。

- **基本监控**：由于许多松散耦合的服务在生产中进行协作，因此肯定会出现在测试环境中难以检测到的问题。 因此，建立监控制度以快速发现严重问题至关重要。 这里的基准是检测技术问题（计数错误、服务可用性等），但也值得监控业务问题（例如检测订单下降）。 如果突然出现问题，那么你需要确保能够快速回滚，因此……

- **快速部署**：需要管理许多服务，您需要能够快速将它们部署到测试环境和生产环境。 通常这将涉及一个可以在不超过几个小时内执行的 [DeploymentPipeline](https://martinfowler.com/bliki/DeploymentPipeline.html)。 在早期阶段进行一些手动干预是可以的，但您很快就会寻求完全自动化。

这些功能意味着重要的组织转变 - 开发人员和运维人员之间的密切协作：[DevOpsCulture](https://martinfowler.com/bliki/DevOpsCulture.html)。 需要这种协作来确保快速完成配置和部署，确保您在监控表明出现问题时能够快速做出反应也很重要。 特别是任何事件管理都需要开发团队和运维部门的参与，既解决眼前的问题，又进行根本原因分析，以确保根本问题得到解决。

完成这种设置后，您就可以为使用少量微服务的第一个系统做好准备了。 部署该系统并在生产中使用它，期望学到很多关于保持其健康并确保 DevOps 协作良好运行的知识。 在增加服务数量之前，给自己一些时间来做到这一点，从中学习并增强能力。

如果您现在不具备这些功能，则应确保开发它们，以便在将微服务系统投入生产时它们已准备就绪。 事实上，这些也是单体系统真正应该具备的功能。 虽然它们并未在软件组织中普遍存在，但在很少的地方它们不应该成为高优先级。

超越少数服务需要更多服务。 您需要通过多种服务跟踪业务交易，并通过完全采用 [ContinuousDelivery](https://martinfowler.com/bliki/ContinuousDelivery.html) 来自动化您的配置和部署。 还需要开始向以产品为中心的团队的转变。 您需要组织您的开发环境，以便开发人员可以轻松地在多个存储库、库和语言之间进行转换。 我的一些联系人感觉到这里可能有一个有用的[成熟度模型](https://martinfowler.com/bliki/MaturityModel.html)，可以帮助组织进行更多的微服务实施——未来几年我们应该会看到更多关于这方面的对话。

## 参考文档

[Microservice Prerequisites](https://martinfowler.com/bliki/MicroservicePrerequisites.html)

[What is provisioning?](https://www.redhat.com/en/topics/automation/what-is-provisioning)